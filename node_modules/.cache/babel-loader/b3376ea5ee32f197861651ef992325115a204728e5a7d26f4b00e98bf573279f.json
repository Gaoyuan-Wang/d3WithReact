{"ast":null,"code":"import*as d3 from\"d3\";//import { useState } from \"react\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";async function loadData(){var fileFath=\"data/Avocado_HassAvocadoBoard_20152023v1.0.1.csv\";const data=await d3.csv(fileFath);return data;}// [{\n//   Date : data[0].Date,\n//   AveragePrice : data[0].AveragePrice,\n//   TotalVolume : data[0].TotalVolume,\n//   plu4046 : data[0].plu4046,\n//   plu4225 : data[0].plu4225,\n//   plu4770 : data[0].plu4770,\n//   TotalBags : data[0].TotalBags,\n//   SmallBags : data[0].SmallBags,\n//   LargeBags : data[0].LargeBags,\n//   XLargeBags : data[0].XLargeBags,\n//   type : data[0].type,\n//   region : data[0].region,\n// }]\nfunction drawPieChart(data){var sum=0;for(const[key,value]of Object.entries(data)){sum+=value;}const width=800,height=800,margin=150;const radius=Math.min(width,height)/2-margin;const svg=d3.select(\"body\").append(\"svg\").attr(\"width\",width).attr(\"height\",height).append(\"g\").attr(\"transform\",\"translate(\".concat(width/2,\", \").concat(height/2,\")\"));const color=d3.scaleOrdinal().range(d3.schemeDark2);const pie=d3.pie().value(function(d){return d[1];});const data_ready=pie(Object.entries(data));var arcGenerator=d3.arc().innerRadius(radius*0.5).outerRadius(radius*0.8);svg.selectAll('whatever').data(data_ready).join('path').attr('d',arcGenerator).attr('fill',function(d){return color(d.data[1]);}).attr(\"stroke\",\"white\").style(\"stroke-width\",\"2px\").style(\"opacity\",0.7);// svg\n// .selectAll('mySlices')\n// .data(data_ready)\n// .join('text')\n// .text(function(d){ return d.data[0] + ':' + String(Math.round((d.data[1] / sum * 100000)/1000.00).toFixed(2)) + '%'})\n// .attr(\"transform\", function(d) { return `translate(${arcGenerator.centroid(d)})`})\n// .style(\"text-anchor\", \"middle\")\n// .style(\"font-size\", 10)\nconst outerArc=d3.arc().innerRadius(radius*0.9).outerRadius(radius*0.9);svg.selectAll('allPolylines').data(data_ready).join('polyline').attr(\"stroke\",\"black\").style(\"fill\",\"none\").attr(\"stroke-width\",1).attr('points',function(d){const posA=arcGenerator.centroid(d);const posB=outerArc.centroid(d);const posC=outerArc.centroid(d);const midangle=d.startAngle+(d.endAngle-d.startAngle)/2;posC[0]=radius*0.95*(midangle<Math.PI?1:-1);return[posA,posB,posC];});svg.selectAll('allLabels').data(data_ready).join('text').text(d=>d.data[0]+': '+String((d.data[1]/sum*100).toFixed(2))+'%').attr('transform',function(d){const pos=outerArc.centroid(d);const midangle=d.startAngle+(d.endAngle-d.startAngle)/2;pos[0]=radius*0.99*(midangle<Math.PI?1:-1);return\"translate(\".concat(pos,\")\");}).style('text-anchor',function(d){const midangle=d.startAngle+(d.endAngle-d.startAngle)/2;return midangle<Math.PI?'start':'end';});}export default function Chart3(){var acc={};acc['SmallBags']=0;acc['LargeBags']=0;acc['XLargeBags']=0;loadData().then(data=>{var count=data.forEach(d=>{//console.log(Number(d.LargeBags));\nif(!isNaN(parseFloat(d.SmallBags))){acc['SmallBags']+=parseFloat(d.SmallBags);}if(!isNaN(parseFloat(d.LargeBags))){acc['LargeBags']+=parseFloat(d.LargeBags);}if(!isNaN(parseFloat(d.XLargeBags))){acc['XLargeBags']+=parseFloat(d.XLargeBags);}});drawPieChart(acc);return data[0];});return/*#__PURE__*/_jsx(\"div\",{});}","map":{"version":3,"names":["d3","jsx","_jsx","loadData","fileFath","data","csv","drawPieChart","sum","key","value","Object","entries","width","height","margin","radius","Math","min","svg","select","append","attr","concat","color","scaleOrdinal","range","schemeDark2","pie","d","data_ready","arcGenerator","arc","innerRadius","outerRadius","selectAll","join","style","outerArc","posA","centroid","posB","posC","midangle","startAngle","endAngle","PI","text","String","toFixed","pos","Chart3","acc","then","count","forEach","isNaN","parseFloat","SmallBags","LargeBags","XLargeBags"],"sources":["/Users/wanggaoyuan/Library/CloudStorage/OneDrive-Personal/Desktop/CS5346/d3WithReact/src/PiePlot.jsx"],"sourcesContent":["import * as d3 from \"d3\";\n//import { useState } from \"react\";\n\nasync function loadData() {\n  var fileFath = \"data/Avocado_HassAvocadoBoard_20152023v1.0.1.csv\"\n  const data = await d3.csv(fileFath);\n  return data\n}\n\n// [{\n//   Date : data[0].Date,\n//   AveragePrice : data[0].AveragePrice,\n//   TotalVolume : data[0].TotalVolume,\n//   plu4046 : data[0].plu4046,\n//   plu4225 : data[0].plu4225,\n//   plu4770 : data[0].plu4770,\n//   TotalBags : data[0].TotalBags,\n//   SmallBags : data[0].SmallBags,\n//   LargeBags : data[0].LargeBags,\n//   XLargeBags : data[0].XLargeBags,\n//   type : data[0].type,\n//   region : data[0].region,\n// }]\n\nfunction drawPieChart(data) {\n    var sum = 0;\n    for (const [key, value] of Object.entries(data)) {\n        sum += value;\n    }\n\n    const width = 800,\n        height = 800,\n        margin = 150;\n\n    const radius = Math.min(width, height) / 2 - margin;\n\n    const svg = d3.select(\"body\")\n    .append(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height)\n    .append(\"g\")\n        .attr(\"transform\", `translate(${width/2}, ${height/2})`);\n\n\n    const color = d3.scaleOrdinal()\n    .range(d3.schemeDark2)\n\n    const pie = d3.pie()\n    .value(function(d) {return d[1]})\n    const data_ready = pie(Object.entries(data))\n\n    var arcGenerator = d3.arc()\n        .innerRadius(radius * 0.5)\n        .outerRadius(radius * 0.8)\n\n    svg\n    .selectAll('whatever')\n    .data(data_ready)\n    .join('path')\n    .attr('d', arcGenerator)\n    .attr('fill', function(d){ return(color(d.data[1])) })\n    .attr(\"stroke\", \"white\")\n    .style(\"stroke-width\", \"2px\")\n    .style(\"opacity\", 0.7)\n\n    // svg\n    // .selectAll('mySlices')\n    // .data(data_ready)\n    // .join('text')\n    // .text(function(d){ return d.data[0] + ':' + String(Math.round((d.data[1] / sum * 100000)/1000.00).toFixed(2)) + '%'})\n    // .attr(\"transform\", function(d) { return `translate(${arcGenerator.centroid(d)})`})\n    // .style(\"text-anchor\", \"middle\")\n    // .style(\"font-size\", 10)\n\n    const outerArc = d3.arc()\n        .innerRadius(radius * 0.9)\n        .outerRadius(radius * 0.9)\n\n    svg.selectAll('allPolylines')\n        .data(data_ready)\n        .join('polyline')\n        .attr(\"stroke\", \"black\")\n        .style(\"fill\", \"none\")\n        .attr(\"stroke-width\", 1)\n        .attr('points', function(d) {\n            const posA = arcGenerator.centroid(d)\n            const posB = outerArc.centroid(d)\n            const posC = outerArc.centroid(d)\n            const midangle = d.startAngle + (d.endAngle - d.startAngle) / 2\n            posC[0] = radius * 0.95 * (midangle < Math.PI ? 1 : -1);\n            return [posA, posB, posC]\n        })\n\n    svg.selectAll('allLabels')\n        .data(data_ready)\n        .join('text')\n        .text(d => d.data[0] + ': ' + String((d.data[1] / sum * 100).toFixed(2)) + '%')\n        .attr('transform', function(d) {\n            const pos = outerArc.centroid(d);\n            const midangle = d.startAngle + (d.endAngle - d.startAngle) / 2\n            pos[0] = radius * 0.99 * (midangle < Math.PI ? 1 : -1);\n            return `translate(${pos})`;\n        })\n        .style('text-anchor', function(d) {\n            const midangle = d.startAngle + (d.endAngle - d.startAngle) / 2\n            return (midangle < Math.PI ? 'start' : 'end')\n        })\n}\n\n\nexport default function Chart3() {\n    var acc = {};\n    acc['SmallBags'] = 0;\n    acc['LargeBags'] = 0;\n    acc['XLargeBags'] = 0;\n    loadData().then((data) => {\n        var count = data.forEach((d) => {\n            //console.log(Number(d.LargeBags));\n            if(!isNaN(parseFloat(d.SmallBags))){\n                acc['SmallBags'] += parseFloat(d.SmallBags);\n            }\n            if(!isNaN(parseFloat(d.LargeBags))){\n                acc['LargeBags'] += parseFloat(d.LargeBags);\n            }\n            if(!isNaN(parseFloat(d.XLargeBags))){\n                acc['XLargeBags'] += parseFloat(d.XLargeBags);\n            }\n    })\n    drawPieChart(acc);\n    return data[0];\n  });\n  \n  return (\n    <div>\n    </div>\n  )\n}"],"mappings":"AAAA,MAAO,GAAK,CAAAA,EAAE,KAAM,IAAI,CACxB;AAAA,OAAAC,GAAA,IAAAC,IAAA,yBAEA,cAAe,CAAAC,QAAQA,CAAA,CAAG,CACxB,GAAI,CAAAC,QAAQ,CAAG,kDAAkD,CACjE,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAL,EAAE,CAACM,GAAG,CAACF,QAAQ,CAAC,CACnC,MAAO,CAAAC,IAAI,CACb,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,QAAS,CAAAE,YAAYA,CAACF,IAAI,CAAE,CACxB,GAAI,CAAAG,GAAG,CAAG,CAAC,CACX,IAAK,KAAM,CAACC,GAAG,CAAEC,KAAK,CAAC,EAAI,CAAAC,MAAM,CAACC,OAAO,CAACP,IAAI,CAAC,CAAE,CAC7CG,GAAG,EAAIE,KAAK,CAChB,CAEA,KAAM,CAAAG,KAAK,CAAG,GAAG,CACbC,MAAM,CAAG,GAAG,CACZC,MAAM,CAAG,GAAG,CAEhB,KAAM,CAAAC,MAAM,CAAGC,IAAI,CAACC,GAAG,CAACL,KAAK,CAAEC,MAAM,CAAC,CAAG,CAAC,CAAGC,MAAM,CAEnD,KAAM,CAAAI,GAAG,CAAGnB,EAAE,CAACoB,MAAM,CAAC,MAAM,CAAC,CAC5BC,MAAM,CAAC,KAAK,CAAC,CACTC,IAAI,CAAC,OAAO,CAAET,KAAK,CAAC,CACpBS,IAAI,CAAC,QAAQ,CAAER,MAAM,CAAC,CAC1BO,MAAM,CAAC,GAAG,CAAC,CACPC,IAAI,CAAC,WAAW,cAAAC,MAAA,CAAeV,KAAK,CAAC,CAAC,OAAAU,MAAA,CAAKT,MAAM,CAAC,CAAC,KAAG,CAAC,CAG5D,KAAM,CAAAU,KAAK,CAAGxB,EAAE,CAACyB,YAAY,CAAC,CAAC,CAC9BC,KAAK,CAAC1B,EAAE,CAAC2B,WAAW,CAAC,CAEtB,KAAM,CAAAC,GAAG,CAAG5B,EAAE,CAAC4B,GAAG,CAAC,CAAC,CACnBlB,KAAK,CAAC,SAASmB,CAAC,CAAE,CAAC,MAAO,CAAAA,CAAC,CAAC,CAAC,CAAC,EAAC,CAAC,CACjC,KAAM,CAAAC,UAAU,CAAGF,GAAG,CAACjB,MAAM,CAACC,OAAO,CAACP,IAAI,CAAC,CAAC,CAE5C,GAAI,CAAA0B,YAAY,CAAG/B,EAAE,CAACgC,GAAG,CAAC,CAAC,CACtBC,WAAW,CAACjB,MAAM,CAAG,GAAG,CAAC,CACzBkB,WAAW,CAAClB,MAAM,CAAG,GAAG,CAAC,CAE9BG,GAAG,CACFgB,SAAS,CAAC,UAAU,CAAC,CACrB9B,IAAI,CAACyB,UAAU,CAAC,CAChBM,IAAI,CAAC,MAAM,CAAC,CACZd,IAAI,CAAC,GAAG,CAAES,YAAY,CAAC,CACvBT,IAAI,CAAC,MAAM,CAAE,SAASO,CAAC,CAAC,CAAE,MAAO,CAAAL,KAAK,CAACK,CAAC,CAACxB,IAAI,CAAC,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CACrDiB,IAAI,CAAC,QAAQ,CAAE,OAAO,CAAC,CACvBe,KAAK,CAAC,cAAc,CAAE,KAAK,CAAC,CAC5BA,KAAK,CAAC,SAAS,CAAE,GAAG,CAAC,CAEtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,KAAM,CAAAC,QAAQ,CAAGtC,EAAE,CAACgC,GAAG,CAAC,CAAC,CACpBC,WAAW,CAACjB,MAAM,CAAG,GAAG,CAAC,CACzBkB,WAAW,CAAClB,MAAM,CAAG,GAAG,CAAC,CAE9BG,GAAG,CAACgB,SAAS,CAAC,cAAc,CAAC,CACxB9B,IAAI,CAACyB,UAAU,CAAC,CAChBM,IAAI,CAAC,UAAU,CAAC,CAChBd,IAAI,CAAC,QAAQ,CAAE,OAAO,CAAC,CACvBe,KAAK,CAAC,MAAM,CAAE,MAAM,CAAC,CACrBf,IAAI,CAAC,cAAc,CAAE,CAAC,CAAC,CACvBA,IAAI,CAAC,QAAQ,CAAE,SAASO,CAAC,CAAE,CACxB,KAAM,CAAAU,IAAI,CAAGR,YAAY,CAACS,QAAQ,CAACX,CAAC,CAAC,CACrC,KAAM,CAAAY,IAAI,CAAGH,QAAQ,CAACE,QAAQ,CAACX,CAAC,CAAC,CACjC,KAAM,CAAAa,IAAI,CAAGJ,QAAQ,CAACE,QAAQ,CAACX,CAAC,CAAC,CACjC,KAAM,CAAAc,QAAQ,CAAGd,CAAC,CAACe,UAAU,CAAG,CAACf,CAAC,CAACgB,QAAQ,CAAGhB,CAAC,CAACe,UAAU,EAAI,CAAC,CAC/DF,IAAI,CAAC,CAAC,CAAC,CAAG1B,MAAM,CAAG,IAAI,EAAI2B,QAAQ,CAAG1B,IAAI,CAAC6B,EAAE,CAAG,CAAC,CAAG,CAAC,CAAC,CAAC,CACvD,MAAO,CAACP,IAAI,CAAEE,IAAI,CAAEC,IAAI,CAAC,CAC7B,CAAC,CAAC,CAENvB,GAAG,CAACgB,SAAS,CAAC,WAAW,CAAC,CACrB9B,IAAI,CAACyB,UAAU,CAAC,CAChBM,IAAI,CAAC,MAAM,CAAC,CACZW,IAAI,CAAClB,CAAC,EAAIA,CAAC,CAACxB,IAAI,CAAC,CAAC,CAAC,CAAG,IAAI,CAAG2C,MAAM,CAAC,CAACnB,CAAC,CAACxB,IAAI,CAAC,CAAC,CAAC,CAAGG,GAAG,CAAG,GAAG,EAAEyC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAG,GAAG,CAAC,CAC9E3B,IAAI,CAAC,WAAW,CAAE,SAASO,CAAC,CAAE,CAC3B,KAAM,CAAAqB,GAAG,CAAGZ,QAAQ,CAACE,QAAQ,CAACX,CAAC,CAAC,CAChC,KAAM,CAAAc,QAAQ,CAAGd,CAAC,CAACe,UAAU,CAAG,CAACf,CAAC,CAACgB,QAAQ,CAAGhB,CAAC,CAACe,UAAU,EAAI,CAAC,CAC/DM,GAAG,CAAC,CAAC,CAAC,CAAGlC,MAAM,CAAG,IAAI,EAAI2B,QAAQ,CAAG1B,IAAI,CAAC6B,EAAE,CAAG,CAAC,CAAG,CAAC,CAAC,CAAC,CACtD,mBAAAvB,MAAA,CAAoB2B,GAAG,MAC3B,CAAC,CAAC,CACDb,KAAK,CAAC,aAAa,CAAE,SAASR,CAAC,CAAE,CAC9B,KAAM,CAAAc,QAAQ,CAAGd,CAAC,CAACe,UAAU,CAAG,CAACf,CAAC,CAACgB,QAAQ,CAAGhB,CAAC,CAACe,UAAU,EAAI,CAAC,CAC/D,MAAQ,CAAAD,QAAQ,CAAG1B,IAAI,CAAC6B,EAAE,CAAG,OAAO,CAAG,KAAK,CAChD,CAAC,CAAC,CACV,CAGA,cAAe,SAAS,CAAAK,MAAMA,CAAA,CAAG,CAC7B,GAAI,CAAAC,GAAG,CAAG,CAAC,CAAC,CACZA,GAAG,CAAC,WAAW,CAAC,CAAG,CAAC,CACpBA,GAAG,CAAC,WAAW,CAAC,CAAG,CAAC,CACpBA,GAAG,CAAC,YAAY,CAAC,CAAG,CAAC,CACrBjD,QAAQ,CAAC,CAAC,CAACkD,IAAI,CAAEhD,IAAI,EAAK,CACtB,GAAI,CAAAiD,KAAK,CAAGjD,IAAI,CAACkD,OAAO,CAAE1B,CAAC,EAAK,CAC5B;AACA,GAAG,CAAC2B,KAAK,CAACC,UAAU,CAAC5B,CAAC,CAAC6B,SAAS,CAAC,CAAC,CAAC,CAC/BN,GAAG,CAAC,WAAW,CAAC,EAAIK,UAAU,CAAC5B,CAAC,CAAC6B,SAAS,CAAC,CAC/C,CACA,GAAG,CAACF,KAAK,CAACC,UAAU,CAAC5B,CAAC,CAAC8B,SAAS,CAAC,CAAC,CAAC,CAC/BP,GAAG,CAAC,WAAW,CAAC,EAAIK,UAAU,CAAC5B,CAAC,CAAC8B,SAAS,CAAC,CAC/C,CACA,GAAG,CAACH,KAAK,CAACC,UAAU,CAAC5B,CAAC,CAAC+B,UAAU,CAAC,CAAC,CAAC,CAChCR,GAAG,CAAC,YAAY,CAAC,EAAIK,UAAU,CAAC5B,CAAC,CAAC+B,UAAU,CAAC,CACjD,CACR,CAAC,CAAC,CACFrD,YAAY,CAAC6C,GAAG,CAAC,CACjB,MAAO,CAAA/C,IAAI,CAAC,CAAC,CAAC,CAChB,CAAC,CAAC,CAEF,mBACEH,IAAA,SACK,CAAC,CAEV"},"metadata":{},"sourceType":"module","externalDependencies":[]}